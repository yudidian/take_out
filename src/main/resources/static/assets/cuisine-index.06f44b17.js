import{b as Ie,u as xe,r as f,v as De,G as Se,E as k,f as i,x as Ne,o as m,c as C,g as a,z as X,m as S,w as o,h as $,F as z,a as B,t as Q,n as M,B as Re,j as y,H as Ue,y as ze}from"./index.733e81c8.js";import{b as He}from"./category.7f8b4041.js";import{g as Y,u as P,a as $e,b as Be,c as Me,d as Ee}from"./dish.59594474.js";import{p as Ae}from"./plus.f18ea452.js";var E,Fe=new Uint8Array(16);function Ge(){if(!E&&(E=typeof crypto!="undefined"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto!="undefined"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!E))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return E(Fe)}var Le=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function Pe(s){return typeof s=="string"&&Le.test(s)}var r=[];for(var T=0;T<256;++T)r.push((T+256).toString(16).substr(1));function Te(s){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,h=(r[s[n+0]]+r[s[n+1]]+r[s[n+2]]+r[s[n+3]]+"-"+r[s[n+4]]+r[s[n+5]]+"-"+r[s[n+6]]+r[s[n+7]]+"-"+r[s[n+8]]+r[s[n+9]]+"-"+r[s[n+10]]+r[s[n+11]]+r[s[n+12]]+r[s[n+13]]+r[s[n+14]]+r[s[n+15]]).toLowerCase();if(!Pe(h))throw TypeError("Stringified UUID is invalid");return h}function Ke(s,n,h){s=s||{};var _=s.random||(s.rng||Ge)();if(_[6]=_[6]&15|64,_[8]=_[8]&63|128,n){h=h||0;for(var b=0;b<16;++b)n[h+b]=_[b];return n}return Te(_)}const je=y(" \u7F16\u8F91 "),Je=y(" \u5220\u9664 "),Oe=y(" \u7981\u7528 "),We={class:"flavor"},qe={key:0},Xe={class:"handler-btn"},Qe=y(" \u6DFB\u52A0 "),Ye=y(" \u5220\u9664 "),Ze=y(" +\u6DFB\u52A0\u53E3\u5473 "),ea=["src"],aa={class:"dialog-footer"},la=y("\u53D6\u6D88"),ta=y("\u786E\u5B9A"),oa={setup(s){const n="http://localhost:8089/download?fileName=",h=xe(),_=f(""),b=f(!1),A=f(""),Z=f(null),V=f(""),I=f({total:0,pages:[]}),H=f([]),N=f(!1),x=f(!1),F=f([]),R=f(""),K=[{name:"\u751C\u5473",value:["\u65E0\u7CD6","\u5C11\u7CD6","\u534A\u7CD6","\u591A\u7CD6","\u5168\u7CD6"]},{name:"\u6E29\u5EA6",value:["\u70ED\u996E","\u5E38\u6E29","\u53BB\u51B0","\u5C11\u51B0","\u591A\u51B0"]},{name:"\u5FCC\u53E3",value:["\u4E0D\u8981\u8471","\u4E0D\u8981\u849C","\u4E0D\u8981\u9999\u83DC","\u4E0D\u8981\u8FA3"]},{name:"\u8FA3\u5EA6",value:["\u4E0D\u8FA3","\u5FAE\u8FA3","\u4E2D\u8FA3","\u91CD\u8FA3"]}],G=Ke(),v=f([]),d=f({name:"",categoryId:"",code:G,flavors:[],image:"",description:"",price:0});De(()=>{re(),U()}),Se(v.value,()=>{d.value.flavors=v.value.map(e=>({name:e.name,value:JSON.stringify(e.value)}))});const ee=e=>{e.forEach(l=>{H.value.push(l.id)})},ae=e=>{d.value.image=e.msg,V.value=`http://localhost:8080/download?fileName=${e.msg}`},le=e=>(console.log(e.type),["image/png","image/jpeg"].findIndex(u=>u===e.type)===-1?(k.error("\u8BF7\u4E0A\u4F20\u56FE\u7247"),!1):e.size/1024/1024>2?(k.error("\u56FE\u7247\u6700\u5927\u4E3A2MB!"),!1):!0),te=(e,l)=>{const c=v.value[l].value.findIndex(u=>u===e);v.value[l].value.splice(c,1)},j=e=>{v.value[e].value.push(A.value),b.value=!1},oe=()=>{b.value=!0},se=()=>{v.value.push({})},ne=(e,l)=>{const c=K.find(u=>u.name===e);v.value[l]=c},ue=e=>{v.value.splice(e,1)},re=async()=>{const e=await He();e.code===1&&(F.value=e.info)},ie=e=>{d.value.categoryId=e,R.value=F.value.find(l=>l.id===e).name},de=async()=>{let e;N.value?(e=await $e(d.value),N.value=!1):e=await Be(d.value),x.value=!1,e.code===1?(k.success({message:e.msg}),await U()):k.error({message:e.msg}),d.value={name:"",categoryId:"",code:G,flavors:[],image:"",description:"",price:0},V.value="",R.value="",v.value=[]},U=async()=>{const e=await Y({page:1,pageSize:10,name:_.value});e.code===1?(I.value.total=e.info.total,I.value.pages=e.info.records):k.error({message:e.msg})},ce=async e=>{N.value=!0;const l=await Me(e);l.code===1?(x.value=!0,d.value=l.info,R.value=l.info.categoryName,V.value=`http://localhost:8080/download?fileName=${l.info.image}`,v.value=l.info.flavors.map(c=>({name:c.name,value:JSON.parse(c.value)}))):k.error({message:l.msg})},me=()=>{x.value=!1,N.value=!1,d.value={name:"",categoryId:"",code:G,flavors:[],image:"",description:"",price:0},V.value="",R.value="",v.value=[]},J=async(e,l)=>{const c={id:e};l==="delete"?c.isDeleted=1:c.status=0;const u=await Ee(c);u.code===1?(k.success({message:u.msg}),await U()):k.error({message:u.msg}),delete c.isDeleted,delete c.status},ve=async e=>{switch(e){case 1:{await P({allId:H.value,isDeleted:1});break}case 2:{await P({allId:H.value,status:1});break}case 3:{await P({allId:H.value,status:0});break}}await U()},pe=async e=>{_.value=e,await U()};return(e,l)=>{const c=i("MyHeader"),u=i("el-table-column"),fe=i("el-avatar"),w=i("el-button"),_e=i("el-table"),ge=i("MyPagination"),L=i("el-input"),D=i("el-form-item"),O=i("el-option"),W=i("el-select"),ye=i("el-input-number"),he=i("el-tag"),be=i("el-icon"),we=i("el-upload"),ke=i("el-form"),Ce=i("el-dialog"),Ve=Ne("loading");return m(),C(z,null,[a(c,{onShowDialog:l[0]||(l[0]=t=>x.value=t),onGetKeyWords:pe,onListHandler:ve}),X((m(),S(_e,{ref:"multipleTableRef",data:I.value.pages,style:{width:"100%"},onSelect:ee},{default:o(()=>[a(u,{type:"selection",width:"40"}),a(u,{label:"\u83DC\u54C1\u540D\u79F0",width:"120",prop:"name"}),a(u,{label:"\u56FE\u7247",width:"140"},{default:o(t=>[a(fe,{shape:"square",size:100,fit:"fill",src:$(n)+t.row.image},null,8,["src"])]),_:1}),a(u,{label:"\u83DC\u54C1\u5206\u7C7B",prop:"categoryName"}),a(u,{label:"\u552E\u4EF7",prop:"price"}),a(u,{label:"\u9500\u552E\u72B6\u6001",prop:"status"},{default:o(t=>[B("span",null,Q(t.row.status===1?"\u9500\u552E\u4E2D":"\u505C\u552E"),1)]),_:1}),a(u,{label:"\u6700\u540E\u64CD\u4F5C\u65F6\u95F4",property:"updateTime"}),a(u,{label:"\u64CD\u4F5C"},{default:o(t=>[a(w,{text:"",size:"small",type:"primary",onClick:g=>ce(t.row.id)},{default:o(()=>[je]),_:2},1032,["onClick"]),a(w,{text:"",size:"small",type:"warning",onClick:g=>J(t.row.id,"delete")},{default:o(()=>[Je]),_:2},1032,["onClick"]),a(w,{text:"",size:"small",type:"danger",onClick:g=>J(t.row.id,"forbidden")},{default:o(()=>[Oe]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[Ve,I.value.pages.length<=0]]),a(ge,{"get-info":$(Y),total:I.value.total,onGetPageMessage:l[1]||(l[1]=t=>I.value.pages=t)},null,8,["get-info","total"]),a(Ce,{modelValue:x.value,"onUpdate:modelValue":l[6]||(l[6]=t=>x.value=t),title:N.value?"\u7F16\u8F91\u5546\u54C1":"\u4FEE\u6539\u5546\u54C1","destroy-on-close":"","close-on-click-modal":!1},{footer:o(()=>[B("span",aa,[a(w,{onClick:me},{default:o(()=>[la]),_:1}),a(w,{type:"primary",onClick:de},{default:o(()=>[ta]),_:1})])]),default:o(()=>[a(ke,{model:d.value,"label-position":"top"},{default:o(()=>[a(D,{label:"\u83DC\u54C1\u540D\u79F0","label-width":"200px"},{default:o(()=>[a(L,{modelValue:d.value.name,"onUpdate:modelValue":l[2]||(l[2]=t=>d.value.name=t),autocomplete:"off"},null,8,["modelValue"])]),_:1}),a(D,{label:"\u83DC\u54C1\u5206\u7C7B","label-width":200},{default:o(()=>[a(W,{"model-value":R.value,placeholder:"\u8BF7\u9009\u62E9\u83DC\u54C1\u5206\u7C7B",onChange:ie},{default:o(()=>[(m(!0),C(z,null,M(F.value,t=>(m(),S(O,{key:t.id,label:t.name,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["model-value"])]),_:1}),a(D,{label:"\u83DC\u54C1\u4EF7\u683C","label-width":200},{default:o(()=>[a(ye,{modelValue:d.value.price,"onUpdate:modelValue":l[3]||(l[3]=t=>d.value.price=t),min:1,max:1e3},null,8,["modelValue"])]),_:1}),a(D,{label:"\u53E3\u5473\u505A\u6CD5\u914D\u7F6E","label-width":200,class:"item-flavor"},{default:o(()=>[B("ul",We,[v.value.length>0?(m(),C("p",qe," \u53E3\u5473\u540D\uFF083\u4E2A\u5B57\u5185\uFF09\u53E3\u5473\u6807\u7B7E\uFF08\u8F93\u5165\u6807\u7B7E\u56DE\u8F66\u6DFB\u52A0\uFF09 ")):Re("",!0),(m(!0),C(z,null,M(v.value,(t,g)=>(m(),C("li",{key:g},[a(W,{class:"m-2",placeholder:"\u8BF7\u9009\u62E9\u53E3\u5473","model-value":t.name,onChange:p=>ne(p,g)},{default:o(()=>[(m(),C(z,null,M(K,(p,q)=>a(O,{key:q,label:p.name,value:p.name},null,8,["label","value"])),64))]),_:2},1032,["model-value","onChange"]),(m(!0),C(z,null,M(t.value,p=>(m(),S(he,{key:p,class:"mx-1",closable:"","disable-transitions":!1,onClose:q=>te(p,g)},{default:o(()=>[y(Q(p),1)]),_:2},1032,["onClose"]))),128)),X(B("div",Xe,[b.value?(m(),S(L,{key:0,ref_for:!0,ref_key:"InputRef",ref:Z,modelValue:A.value,"onUpdate:modelValue":l[4]||(l[4]=p=>A.value=p),class:"ml-1 w-20",size:"small",onKeyup:ze(p=>j(g),["enter"]),onBlur:p=>j(g)},null,8,["modelValue","onKeyup","onBlur"])):(m(),S(w,{key:1,class:"ml-1",size:"small",type:"success",onClick:oe},{default:o(()=>[Qe]),_:1})),a(w,{class:"delete-flavor",size:"small",type:"danger",onClick:p=>ue(g)},{default:o(()=>[Ye]),_:2},1032,["onClick"])],512),[[Ue,t.value&&t.value.length>0]])]))),128))]),a(w,{type:"primary",onClick:se},{default:o(()=>[Ze]),_:1})]),_:1}),a(D,{label:"\u83DC\u54C1\u56FE\u7247","label-width":200,class:"flavor-image"},{default:o(()=>[a(we,{class:"avatar-uploader",action:"api/upload",headers:{token:$(h).getters.token},"show-file-list":!1,"on-success":ae,"before-upload":le},{default:o(()=>[V.value?(m(),C("img",{key:0,src:V.value,class:"avatar"},null,8,ea)):(m(),S(be,{key:1,class:"avatar-uploader-icon"},{default:o(()=>[a($(Ae))]),_:1}))]),_:1},8,["headers"])]),_:1}),a(D,{label:"\u83DC\u54C1\u63CF\u8FF0","label-width":200,class:"flavor-textArea"},{default:o(()=>[a(L,{modelValue:d.value.description,"onUpdate:modelValue":l[5]||(l[5]=t=>d.value.description=t),maxlength:"200",placeholder:"\u8BF7\u8F93\u5165\u83DC\u54C1\u63CF\u8FF0","show-word-limit":"",type:"textarea"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])],64)}}};var ia=Ie(oa,[["__scopeId","data-v-98882c22"]]);export{ia as default};
